<DOCTYPE! html>
<html>
  <head>
    <title>Sci-Fi RPG Sim</title>
    <style>
    body {
      background-color: powderblue;
    }
    h1 {
      color: blue;
    }
    p {
      color: red;
    }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/p5@1.4.1/lib/p5.min.js"></script>
  </head>
  <body>
    <h1>Game:</h1>
    <div id=music align="top">
	    <a href="https://youtube.com/playlist?list=PLbBiRzerJo8ZvHfUQ4V2MDw3eUgI9CHpO&si=gW20c20Sl9V6OU44">RPG Background Music Playlist</a>
    </div>
    <div id="feed" align="right">
	    <label>Events:</label>
    </div>
    <div id="race" align="center">
	<label for="races">Choose a race:</label>
	<select name="races" id="races">
		<option value="Elf">Elf</option>
		<option value="Gnome">Gnome</option>
		<option value="Goblin">Goblin</option>
		<option value="Halfling">Halfling</option>
		<option value="Human">Human</option>
		<option value="Leshy">Leshy</option>
		<option value="Orc">Orc</option>
		<option value="Barathu">Barathu</option>
		<option value="Contemplative">Contemplative</option>
		<option value="Draelik">Draelik</option>
		<option value="Dragonkin">Dragonkin</option>
		<option value="Drow">Drow</option>
		<option value="Formian">Formian</option>
		<option value="Space Goblin">Space Goblin</option>
		<option value="Gray">Gray</option>
		<option value="Haan">Haan</option>
		<option value="Ikeshti">Ikeshti</option>
		<option value="Kalo">Kalo</option>
		<option value="Maraquoi">Maraquoi</option>
		<option value="Nuar">Nuar</option>
		<option value="Reptoid">Reptoid</option>
		<option value="Ryphorian">Ryphorian</option>
		<option value="Sarcesian">Sarcesian</option>
		<option value="Shobhad">Shobhad</option>
		<option value="Skittermander">Skittermander</option>
		<option value="Urog">Urog</option>
		<option value="Verthani">Verthani</option>
		<option value="Witchwyrd">Witchwyrd</option>
		<option value="Wrikreechee">Wrikreechee</option>
	</select>
    </div>
    <div id="class" align="center">
	<label for="classes">Choose a class:</label>
	<select name="classes" id="classes">
		<option value="Biohacker">Biohacker</option>
		<option value="Envoy">Envoy</option>
		<option value="Evolutionist">Evolutionist</option>
		<option value="Mechanic">Mechanic</option>
		<option value="Mystic">Mystic</option>
		<option value="Nanocyte">Nanocyte</option>
		<option value="Operative">Operative</option>
		<option value="Precog">Precog</option>
		<option value="Solarian">Solarian</option>
		<option value="Soldier">Soldier</option>
		<option value="Technomancer">Technomancer</option>
		<option value="Vanguard">Vanguard</option>
		<option value="Witchwarper">Witchwarper</option>
	</select>
    </div>
    <div id="checks" align="center">
	<label for="checks">Choose a check:</label>
	<select name="checks" id="checks">
		<option value="">Athletics (climb, force open, grapple, high jump, long jump, reposition, shove, swim, trip, disarm)</option>
		<option value="">Melee Attack [str. mod. only]</option>
		<option value="">Acrobatics (balance, tumble through, fly maneuver, squeeze)</option>
		<option value="">Piloting</option>
		<option value="">Stealth (conceal object, hide, sneak)</option>
		<option value="">Thievery (palm object, steal, disable device, pick lock)</option>
		<option value="">Ranged Attack [dex. mod. only]</option>
		<option value="">Arcana (recall knowledge, borrow an arcane spell, decipher writing, identify magic, learn a spell)</option>
		<option value="">Computers</option>
		<option value="">Crafting (recall knowledge, repair, craft, earn income, identify alchemy)</option>
		<option value="">Medicine (first aid, disease, poison, wounds)</option>
		<option value="">Occultism (recall knowledge, decipher writing, identify magic, learn a spell)</option>
		<option value="">Society (recall knowledge, subsist, create forgery)</option>
		<option value="">Medicine (first aid, disease, poison, wounds)</option>
		<option value="">Nature (command animal, recall knowledge, identify magic, learn a spell)</option>
		<option value="">Survival (sense direction, subsist, cover tracks, track)</option>
		<option value="">Religion (recall knowledge, decipher writing, identify magic, learn a spell)</option>
		<option value="">Perception [wis. mod. & prof. bonus only]</option>
		<option value="">Deception (create diversion, impersonate, lie, feint) </option>
		<option value="">Diplomacy (gather information, make impression, request)</option>
		<option value="">Intimidate (coerce, demoralize)</option>
	</select>
    </div>
    <script>
	function create_character(name, str, dex, con, int, wis, cha) {
		this.name = name;		
		this.hp = con*Math.floor((str, dex, con, int, wis, cha)/24); 
		if(this.hp < 1) {
			this.hp = 1;
		}
		this.speed = 30; 
		this.str = str;
		this.dex = dex;
		this.con = con;
		this.int = int; 
		this.wis = wis; 
		this.cha = cha;
	}
	function create_race(name, hp, speed, str, dex, con, int, wis, cha) {
		this.name = name; 
		this.hp = hp;
		this.speed = speed;
		this.str = str;
		this.dex = dex;
		this.con = con;
		this.int = int;
		this.wis = wis;
		this.cha = cha;
	}
	function create_class(name, hp, skills, Acrobatics, Arcana, Athletics, Computers, Crafting, Deception, Diplomacy, Intimidate, Lore, Medicine, Nature, Occultism, Perception, Piloting, Religion, Society, Stealth, Survival, Thievery) {
		this.name = name;
		this.hp = hp;
		this.skills = skills;
		this.Acrobatics = Acrobatics; 
		this.Arcana = Arcana; 
		this.Athletics = Athletics; 
		this.Computers = Computers; 
		this.Crafting = Crafting; 
		this.Deception = Deception; 
		this.Diplomacy = Diplomacy; 
		this.Intimidate = Intimidate; 
		this.Lore = Lore; 
		this.Medicine = Medicine; 
		this.Nature = Nature; 
		this.Occultism = Occultism; 
		this.Perception = Perception;
		this.Piloting = Piloting; 
		this.Religion = Religion; 
		this.Society = Society; 
		this.Stealth = Stealth; 
		this.Survival = Survival; 
		this.Thievery = Thievery;
	}
	races = [
		new create_race("Dwarf", 10, 20, 0, 0, 1, 0, 1, 0),
		new create_race("Elf", 6, 30, 0, 1, 0, 1, 0, 0),
		new create_race("Gnome", 8, 25, -2, 2, 1, 0, 0, 1),
		new create_race("Goblin", 6, 25, -2, 3, 0, 0, 0, 1),
		new create_race("Halfling", 6, 25, -2, 3, 0, 0, 1, 0),
		new create_race("Human", 8, 25, 0, 0, 1, 1, 0, 0),
		new create_race("Leshy", 8, 25, -2, 2, 1, 0, 1, 0),
		new create_race("Orc", 10, 25, 1, 0, 0, 0, 1, 0),
		new create_race("Barathu", 6, 30, 0, -2, 2, 0, 2, 0),
		new create_race("Contemplative", 2, 30, -2, 0, -2, 4, 0, 2),
		new create_race("Draelik", 4, 30, 0, 0, 2, 0, 2, -2),
		new create_race("Dragonkin", 6, 30, 6, -4, 0, 0, 0, 0),
		new create_race("Drow", 4, 30, 0, 2, -2, 0, 0, 2),
		new create_race("Formian", 4, 30, 2, 0, 2, 0, -2, 0),
		new create_race("Space Goblin", 2, 35, -2, 6, 0, 0, 0, -2),
		new create_race("Gray", 2, 30, -2, 0, 0, 4, 0, 0),
		new create_race("Haan", 4, 30, 4, 0, 0, -2, 0, 0),
		new create_race("Ikeshti", 4, 30, -2, 4, 0, 2, -2, 0),
		new create_race("Kalo", 2, 30, 0, 2, -2, 0, 2, 0),
		new create_race("Maraquoi", 5, 30, 0, -2, 2, 0, 2, 0),
		new create_race("Nuar", 6, 30, 2, -2, 0, 2, 0, 0),
		new create_race("Reptoid", 5, 30, 2, -2, 0, 0, 0, 2),
		new create_race("Ryphorian", 4, 30, -2, 0, 2, 0, 2, 0),
		new create_race("Sarcesian", 4, 30, 0, 0, 0, 0, 0, 2),
		new create_race("Shobhad", 6, 30, 6, -2, 0, -2, 0, 0),
		new create_race("Skittermander", 2, 30, -2, 4, 0, -2, 0, 2),
		new create_race("Urog", 6, 20, 2, -2, 2, 2, 0, -2),
		new create_race("Verthani", 4, 30, -2, 0, 2, 2, 0, 0),
		new create_race("Witchwyrd", 4, 30, 0, 0, -2, 2, 0, 2),
		new create_race("Wrikreechee", 4, 30, 0, -2, 2, 2, 0, 0)
	];
	classes = [
		new create_class("Biohacker", 12, 4, 0, 0, 0, 2, 2, 2, 2, 0, 4, 4, 0, 0, 4, 0, 0, 2, 0, 0, 2),
		new create_class("Envoy", 12, 8, 2, 0, 2, 2, 2, 4, 2, 2, 2, 2, 0, 0, 4, 2, 0, 2, 0, 0, 2),
		new create_class("Evolutionist", 12, 4, 2, 0, 2, 0, 2, 2, 0, 2, 0, 0, 0, 0, 2, 0, 0, 2, 2, 2, 0),
		new create_class("Mechanic", 12, 4, 0, 0, 2, 2, 2, 0, 0, 0, 4, 2, 0, 0, 2, 2, 0, 0, 0, 0, 0),
		new create_class("Mystic", 12, 6, 0, 0, 0, 0, 2, 2, 2, 2, 4, 0, 0, 0, 4, 0, 2, 2, 0, 2, 0),
		new create_class("Nanocyte", 12, 6, 2, 0, 2, 2, 2, 0, 0, 0, 4, 4, 0, 0, 2, 2, 0, 0, 2, 0, 2),
		new create_class("Operative", 12, 8, 2, 0, 2, 2, 2, 4, 0, 2, 2, 2, 0, 0, 4, 2, 0, 2, 2, 2, 2),
		new create_class("Precog", 10, 6, 2, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 2, 4, 2, 0, 2, 2, 0, 0),
		new create_class("Solarian", 14, 4, 2, 0, 2, 0, 2, 0, 2, 2, 2, 0, 0, 2, 4, 0, 0, 0, 2, 0, 0),
		new create_class("Soldier", 14, 4, 2, 0, 2, 0, 2, 0, 0, 2, 2, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0),
		new create_class("Technomancer", 10, 4, 0, 0, 0, 2, 2, 0, 4, 0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 2),
		new create_class("Vanguard", 14, 6, 2, 0, 2, 0, 2, 0, 2, 2, 0, 4, 0, 2, 2, 0, 0, 2, 2, 2, 0),
		new create_class("Witchwarper", 10, 4, 2, 0, 0, 0, 2, 2, 2, 2, 2, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0)
	];
	
        function keyPressed() {
	  if(zoomed_in) {
	    if(keyCode === LEFT_ARROW) {
	      x_coor -= 50;
	    } else if(keyCode === RIGHT_ARROW) {
	      x_coor += 50;
	    } else if(keyCode === DOWN_ARROW) {
	      z_coor -= 50;
	      characters[0][0].crouching = true;
	    } else if(keyCode === UP_ARROW) {
	      z_coor += 50;
	      characters[0][0].crouching = false;
	    } else if(keyCode === ENTER) {
	      zoomed_in = false;
	      makeGrid(); 
	    }	  
	  } else {
	    if(keyCode === LEFT_ARROW) {
	      playerX -= windowWidth*0.075;
	      makeGrid();
	      drawHexagon(playerX+hexagonSize*(count%2==0)*0.75, playerY, hexagonSize/2, color('rgba(128, 128, 128, 0.5)'));
	    } else if(keyCode === RIGHT_ARROW) {
	      playerX += windowWidth*0.075;
	      makeGrid();
	      drawHexagon(playerX+hexagonSize*(count%2==0)*0.75, playerY, hexagonSize/2, color('rgba(128, 128, 128, 0.5)'));
	    } else if(keyCode === DOWN_ARROW) {
	      playerY -= windowHeight/10;
	      makeGrid();
	      drawHexagon(playerX+hexagonSize*(count%2==0)*0.75, playerY, hexagonSize/2, color('rgba(128, 128, 128, 0.5)'));
	    } else if(keyCode === UP_ARROW) {
	      playerY += windowHeight/10;
	      makeGrid();
	      drawHexagon(playerX+hexagonSize*(count%2==0)*0.75, playerY, hexagonSize/2, color('rgba(128, 128, 128, 0.5)'));
	    } else if(keyCode === ENTER) {
	      zoomed_in = true;
	      make_landscape();  
	    }
          }
        }

	let zoomed_in = false;
	let noiseScale = 1/16; 
	let ocean = "#008dc4"; //Deep Sea, Lakes
	let shore = "#00a9cc"; //Coasts, Wetlands
	let sand = "#eecda3"; //Plains, Deserts  
	let grass = "#7ec850"; //Forests, Valleys
	let stone = "#676767"; //Tundra, Mountains
	let snow = "#fffafa"; //n/a
	let playerX = 0, playerY = 0;
	let size = 8;
        let depth = 512;
        let overlap = 256;
        let treeLine = -64;
        let water = 8;
        let x_coor = 0;
        let y_coor = -256;
        let z_coor = -512;
        let rez1 = 0.01;
	let terrRange = 100; 
	let seed;
	/*Rivers
	Caves
	Rock Formations
	Atmospheric Optics, Astronomy, Weather*/
	function create_weather_event(perception_penalty) {
		this.perception_penalty = perception_penalty;
	}
	weather_events = [ //-perception check penalties
		-1,//Fog 
		-1,//Heavy_Downpour 
		-1,//Cold_Snap 
		-1,//Windstorm 
		-2,//Severe_Hailstorm 
		-2,//Blizzard
		-3,//Supernatural_Storm 
		-3,//Flash_Flood
		-4,//Wildfire 
		-5,//Subsidence 
		-6,//Thunderstorm 
		-8//Tornado
	];
		
	function random_weather_event() {
		occurence = Math.floor(Math.random()*20)+1;
		if(occurence > 16) {
			random = Math.floor(Math.random()*20)+1;
			event = weather_events[0];
			switch(random) {
				case 1, 2, 3:
					event =  weather_events[0];
					break;
				case 4, 5, 6, 7:
					event =  weather_events[1];
					break;
				case 8, 9:
					event =  weather_events[2];
					break;
				case 10, 11, 12:
					event =  weather_events[3];
					break;
				case 13:
					event =  weather_events[4];
					break;
				case 14:
					event =  weather_events[5];
					break;
				case 15:
					event =  weather_events[6];
					break;
				case 16:
					event =  weather_events[7];
					break;
				case 17:
					event =  weather_events[8];
					break;
				case 18:
					event =  weather_events[9];
					break;
				case 19:
					event =  weather_events[10];
					break;
				case 20:
					event =  weather_events[11];
					break;
			}
		}
	}
	    
	function pickColor(i, j) {
	  let h = noise((i)*noiseScale, (j)*noiseScale);
	  let c = "#facade";
	  
	  if(h < 0.05) {
		c = ocean;
	  } else if(h < 0.2) {
		if(random() > pow(h-0.15, 2)*100) {
		  c = ocean;
		} else {
		  c = shore;
		}
	  } else if(h < 0.35) {
		if(random() > pow(h-0.2, 2)*100) {
		  c = shore;
		} else {
		  c = sand;
		}
	  } else if(h < 0.5) {
		if(random() > pow(h-0.35, 2)*100) {
		  c = sand;
		} else {
		  c = grass;
		}
	  }
	  else if(h < 0.65) {
		if(random() > pow(h-0.5, 2)*100) {
		  c = grass;
		} else {
		  c = stone;
		}
	  } else if (h < 0.8) {
		if(random() > pow(h-0.65, 2)*100) {
		  c = stone;
		} else {
		  c = snow;
		}
	  } else {
		c = snow;
	  }
	  
	  return color(c);
	}
	    
	function setup() {
	  seed = millis()*10000;
	  w = min(windowWidth, windowHeight);
	  createCanvas(w, w, WEBGL);
	  r = 64;
	  s = sqrt(3 * pow(r, 2) / 4);
	  hexagons = [];
	
	  let counter = 0;
	  for (let y = 0; y < height + s; y += 2*s) {
		for (let x = 0; x < width + r; x += 3*r) {
			hexagons.push(new Hexagon(x, y, r, counter++));
			hexagons.push(new Hexagon(x + 1.5 * r, y + s, r, counter++));
		}
	  }
	}

	function hexagon(x, y, r) {
		beginShape();
		for (let a = 0; a < 2 * PI; a += 2 * PI / 6) {
			let x2 = cos(a) * r;
			let y2 = sin(a) * r;
			vertex(x + x2, y + y2);
		}
		endShape(CLOSE);
	}
	
	class Hexagon {
		constructor(x, y, r) {
			this.x = x;
			this.y = y;
			this.r = r;
			this.c = pickColor(this.x, this.y)
		}
		render() {
			fill(this.c);
			stroke(0);
			hexagon(this.x-(windowWidth/2), this.y-(windowHeight/2), this.r);
		}
	}
	    
	function makeGrid() {
		clear();
		cam = createCamera();
		cam.camera(0,0,0,0,0,0,0,0,0);
		translate(0,0,0);
		hexagons.forEach(h => {h.render();});
	}

	function make_landscape() {
		clear();
		cam = createCamera();
		colorMode(HSB,360,100,100,100);
		rez1 = 0.01;
		terrRange = 100;
		seed = millis() * 10000; //to vary noise
	
		cam.camera(x_coor,y_coor,z_coor,0,0,0,0,1,0);
		
		    background(220,100,100);
		    for(x = -width/2-256; x < width/2+256; x+=8) {
		        for(x = -width/2-overlap; x < width/2+overlap; x+=size) {
		          for(z=-depth/2-overlap; z <depth/2+overlap; z+=size) {
		            y = (noise(x*rez1+seed, z*rez1+seed)-0.5)*terrRange*2;
		            stroke(0);
		            g = noise(x * rez1+seed+20000,z*rez1+seed+20000)-0.5;
		            fill(125+125*g,95+90*g,60+60*g,100) //grass color
		            if (y<treeLine) {
		              fill (200,20,40); //stone color
		            }
		            if (y>water) {
		              fill(240,100,60,100); //water color
		              y = water;
		              noStroke();
		            }
		            push();
		            translate(x,y,z);
		            box(size); //grass or water
		            translate(0,size*3,0);
		            fill (200,20,40); //stone color
		            box(size,size*5,size); //stone block
		            let treeChance = (noise(x * rez1+seed+10000,z*rez1+seed+10000)-0.5)*90;
		            if(treeChance > 9.5 && y>treeLine && y<water) {
		              translate(0,-size*5,0);
		              fill(0,75,30); //trunk color
		              cylinder(size/2,size*3);
		              translate(-size,-size,-size);
		              fill(120,80,30); //leaves
		              //sphere(size*2);
		              // fill in tree:
		              for(i=0;i<2;i++) {
		                for(j=0;j<3;j++) {
		                  for(k=0;k<3;k++) {
		                    box(size);
		                    translate(0,0,size)
		                  }
		                  translate(size,0,-size*3)
		                } 
		                translate(-size*3,-size,0)
		              }
		              translate(size,0,size);
		              box(size) //cap on tree
		            }
		            pop();
		          }
		        }
		      }
	}
	function draw() {
	  /*if(zoomed_in) {
		  make_landscape(); 
	  } else {*/
		  background(0);
		  stroke(255);
		  noFill();
		  makeGrid();
		  noLoop();
	  //}
	}
    </script>
      <p>Press enter to change view from biome map to local landscape</p>
      <div id="protips" align="left">
	<ul>  
	  <label><h4>Strength</h4></label>
	  <li>Athletics (climb, force open, grapple, high jump, long jump, reposition, shove, swim, trip; disarm)</li>
	  <li>Bonuses for Melee Attack/Damage Rolls: equal to mod</li>
	  <li>n/a</li>
	</ul>
	<ul>  
	  <label><h4>Dexterity</h4></label>
	  <li>Acrobatics (balance, tumble through; fly maneuver, squeeze), Piloting, Stealth (conceal object, hide, sneak), Thievery (palm object, steal; disable device, pick lock)</li>
	  <li>n/a</li>
	  <li>Base Speed: 20 ft/s + (ability score * 1.125) ft/s [assuming rounds are shortened to 4 seconds]</li>
	</ul>
	<ul>  
	  <label><h4>Constitution</h4></label>
	  <li>n/a</li>
	  <li>n/a</li>
	  <li>n/a</li>
	</ul>
	<ul>  
	  <label><h4>Intelligence</h4></label>
	  <li>Arcana (recall knowledge; borrow an arcane spell, decipher writing, identify magic, learn a spell), Computers, Crafting (recall knowledge, repair; craft, earn income, identify alchemy), Medicine (first aid; disease, poison, wounds), Occultism (recall knowledge; decipher writing, identify magic, learn a spell), Society (recall knowledge, subsist; create forgery)</li>
	  <li>n/a</li>
	  <li>n/a</li>
	</ul>
	<ul>  
	  <label><h4>Wisdom</h4></label>
	  <li>Medicine (first aid; disease, poison, wounds), Nature (command animal, recall knowledge; identify magic, learn a spell), Survival (sense direction, subsist; cover tracks, track), Religion (recall knowledge; decipher writing, identify magic, learn a spell)</li>
	  <li>bonus on perception checks against disguise and stealth equal to mod. + prof. bonus</li>
	  <li>n/a</li>
	</ul>
	<ul>  
	  <label><h4>Charisma</h4></label>
	  <li>Deception (create diversion, impersonate, lie; feint), Diplomacy (gather information, make impression, request), Intimidate (coerce, demoralize)</li>
	  <li>n/a</li>
	  <li>n/a</li>
	</ul>
    </div>
  </body>  
</html>
